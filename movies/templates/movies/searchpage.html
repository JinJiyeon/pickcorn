{% extends 'base.html' %}

{% block content %}

<h1>Search Result</h1>

<ul>
  {% if movies|length %}
    <div class="container">
      <br>
      <h3>- ðŸŽ¬ Movies</h3>
      <br>
      <div class="row g-4">
        {% for movie in posts  %}
          <div class="col-4 col-md-2">
            <a href="{% url 'movies:detail' movie.pk %}" class="text-decoration-none">
              <div class="card h-100 border-0">
                <img src="https://image.tmdb.org/t/p/original/{{ movie.poster_path }}" class="card-img-top" alt="movie poster">
                {% comment %} <div class="card-img-overlay">
                  <h5 class="text-center"><span class="badge bg-secondary">{{ movie.title }}</span></h5>
                </div> {% endcomment %}
              </div>
            </a>
          </div>
        {% endfor %}
        <br>
      </div>
        <br>
      <div class="g-4 text-center">
        {% if posts.has_previous %}
        <a href="?page={{ posts.previous_page_number }}&user_page={{ user_posts.number }}&query={{search}}"><button type="button" class="btn btn-warning">previous</button></a>
        {% endif %}
        <span>{{ posts.number }}</span>
        <span>/</span>
        <span>{{ posts.paginator.num_pages }}</span>
        {% if posts.has_next %}
        <a href="?page={{ posts.next_page_number }}&user_page={{ user_posts.number }}&query={{search}}"><button type="button" class="btn btn-warning">next</button></a>
        {% endif %}
        <br>
      </div>
    </div>
  {% else %}
    <br>
    <h3>- ðŸŽ¬ Movies</h3>
    <br>
    <h2>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤...</h2>
    <br>
  {% endif %}

  <br>  
  <hr>
  
  {% if users|length %}
    <div class="container">
      <br>
      <h3>- ðŸ•´ Users</h3>
      <br>
      <div class="row g-4">
        {% for user in user_posts  %}
          <div class="col-4 col-md-2 card bg-dark">
            <a href="{% url 'accounts:profile' user.pk %}" class="text-decoration-none text-center my-3">
              <p>ID: {{ user.username }}</p>
              <p>íŒ”ë¡œìš°: {{ user.followings.all|length }} / íŒ”ë¡œì›Œ: {{ user.followers.all|length }}</p>
              <span>( liked {{ user.like_movies.all|length }} movies )</span>
            </a>
          </div>
        {% endfor %}
      </div>
    </div>
    <div class="g-4 text-center">
      {% if user_posts.has_previous %}
      <a href="?user_page={{ user_posts.previous_page_number }}&page={{ posts.number }}&query={{search}}"><button type="button" class="btn btn-warning">previous</button></a>
      {% endif %}
      <span>{{ user_posts.number }}</span>
      <span>/</span>
      <span>{{ user_posts.paginator.num_pages }}</span>
      {% if user_posts.has_next %}
      <a href="?user_page={{ user_posts.next_page_number }}&page={{ posts.number }}&query={{search}}"><button type="button" class="btn btn-warning">next</button></a>
      {% endif %}
      <br>
    </div>
  {% else %}
    <br>
    <h3>- ðŸ•´ Users</h3>
    <br>
    <h2>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤...</h2>
  {% endif %}
</ul>

{% endblock content %}
