{% extends 'base.html' %}
{% load static %}

{% block css %}
  <link rel="stylesheet" href="{% static 'profile.css' %}">
{% endblock %}

{% block content %}

<br>
<br>
<br>

  <!--í˜ì´ì§€ íƒ€ì´í‹€-->
  
  <h1>{{ person.username|title }}'s profile</h1>

  <!--íŒ”ë¡œìš° ì–¸íŒ”ë¡œìš° ë²„íŠ¼ êµ¬í˜„-->

  <!-- ìê¸°ê°€ ìê¸°ëŠ” íŒ”ë¡œìš° ëª»í•¨-->
  {% if request.user != person %}
    <form action="{% url 'accounts:follow' person.pk%}" method="POST">
      {% csrf_token %}
      <!--ê¸°ì¡´íŒ”ë¡œì›Œë©´ ì–¸íŒ”ê°€ëŠ¥-->
      {% if request.user in person.followers.all %}
      <button>Unfollow</button>
      <!-- ì•„ë‹ˆë©´ íŒ”ë¡œìš°ê°€ëŠ¥-->
      {% else %}
      <button>Follow</button>
      {% endif %}
    </form>
  {% endif %}

  <hr>
  <br>
  {% comment %} íŒ”ë¡œì‰, íŒ”ë¡œì›Œ ìˆ«ì {% endcomment %}

  <h5>
    <b>ğŸ• follower : </b>
    <a href="{% url 'accounts:followers' person.pk %}">{{ person.followers.all|length }}</a>
  </h5>

  <h5>
    <b>ğŸ” following : </b>
    <a href="{% url 'accounts:followings' person.pk %}">{{ person.followings.all|length }}</a>
  </h5>

  <br>
  <hr>
  {% comment %} ì‘ì„±ìì˜ íŒ”ë¡œì‰, íŒ”ë¡œì›Œ ìˆ«ìë¥¼ ë³´ì—¬ì£¼ê³  ìœ ì €ì˜ ì´ë¦„ì„ ëª¨ë‘ ì¶œë ¥

  <h5>followers</h5>
  <ul>
  {% for follower in person.followers.all %}
  <li>{{ follower.username }}</li>
  {% endfor %}
  </ul>



  <h5>followings</h5>
  <ul>
  {% for following in person.followings.all %}
  <li>{{ following.username }}</li>
  {% endfor %}
  </ul>

  <hr> {% endcomment %}


<div class="accordion" id="accordionExample">
  <!--   í”„ë¡œí•„ì˜ ìœ ì €ê°€ ì‘ì„±í•œ ëª¨ë“  ê¸€ì˜ ì œëª© -->
  <div class="accordion-item">
    <h2 class="accordion-header " id="headingOne">
      <button class="accordion-button alert-info collapsed " type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
        <span><b>{{ person.username }}</b> ë‹˜ì´ ì‘ì„±í•œ ë¦¬ë·°</span>
        <span class="badge mx-2"><b>{{ person.article_set.all|length }}</b>ê°œ</span>
      </button>
    </h2>
    <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
      <div class="accordion-body">
        <li>
          {% for article in person.article_set.all %}
            <a class="text-decoration-none" href="{% url 'movies:article_detail' article.pk %}">
              <p>{{ article.title }}</p>
            </a>
          {% endfor %}
        </li>
      </div>
    </div>
  </div>

  <!--   í”„ë¡œí•„ì˜ ìœ ì €ê°€ ì‘ì„±í•œ ëª¨ë“  ëŒ“ê¸€ì˜ ë‚´ìš© -->
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingTwo">
      <button class="accordion-button alert-info collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
        <span><b>{{ person.username }}</b> ë‹˜ì´ ë‚¨ê¸´ ëŒ“ê¸€</span>
        <span class="badge mx-2"><b>{{ person.comment_set.all|length }}</b>ê°œ</span>
      </button>
    </h2>
    <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
      <div class="accordion-body">
        <li>
        {% for comment in person.comment_set.all %}
          <a href="{% url 'movies:article_detail' comment.article.pk %}">
            <p>{{ comment.content }}</p>
          </a>
        {% endfor %}
        </li>
      </div>
    </div>
  </div>

  <!-- ë”°ë´‰í•œ ì˜í™” -->
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingThree">
      <button class="accordion-button alert-info collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
          <span><b>{{ person.username }}</b> ë‹˜ì´ ì¢‹ì•„ìš” ëˆ„ë¥¸ ì˜í™”</span>
          <span class="badge mx-2"><b>{{ person.rated_good_movies.all|length }}</b>ê°œ</span>
      </button>
    </h2>
    <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
      <div class="accordion-body">
        <li>
        {% for good in person.rated_good_movies.all %}
          <p>{{ good.title }}</p>
          <a href="{% url 'movies:detail' good.pk %}">
            <img src="https://image.tmdb.org/t/p/original/{{ good.poster_path }}" alt="no photos yet" width="180">
          </a>
        {% endfor %}
        </li>
      </div>
    </div>

    <!--  ì°œí•œ ì˜í™”ì™€ ìˆ«ì -->
    <div class="accordion-item">
    <h2 class="accordion-header" id="panelsStayOpen-headingOne">
      <button class="accordion-button alert-info collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="false" aria-controls="panelsStayOpen-collapseOne">
          <span><b>{{ person.username }}</b> ë‹˜ì˜ ì°œí•œ ì˜í™” ë¦¬ìŠ¤íŠ¸</span>
      </button>
    </h2>
    <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-headingOne" data-bs-parent="#accordionExample">
      <div class="accordion-body">
        <ul>
        {% for like in person.like_movies.all %}
          <li>{{ like.title }}</li>
          <a href="{% url 'movies:detail' like.pk %}">
            <img src="https://image.tmdb.org/t/p/original/{{ like.poster_path }}" alt="no photos yet" width="180">
          </a>
        {% endfor %}
        </ul>
      </div>
    </div>
    
  </div>
</div>


{% endblock content %}

